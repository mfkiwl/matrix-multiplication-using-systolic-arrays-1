T=[31.25 31.50 32.25 31.50;
31.50 31.75 31.75 31.50;
31.50 32.00 31.25 31.50;
31.50 31.50 32.25 31.50;
31.50 31.75 32.00 31.50;
31.50 31.25 32.00 31.25;
31.00 31.75 32.25 31.75;
31.50 31.75 32.00 31.25;
31.50 32.00 31.75 31.50;
31.25 31.50 32.00 32.00;
31.50 31.25 32.00 31.50;
31.00 32.00 32.00 31.50;
31.50 31.75 31.75 31.75;
31.50 31.50 32.00 31.50;
31.75 31.25 32.50 31.50;
31.25 31.50 32.25 31.50;
31.00 31.50 31.75 31.50;
31.00 31.50 32.00 31.50;
31.50 31.75 32.00 31.50;
31.50 31.25 31.75 31.25;
31.50 31.25 32.25 31.25;
31.50 31.75 32.25 31.00;
31.00 31.50 32.25 31.50;
31.50 31.50 32.25 31.50;
31.50 31.75 32.00 31.50;
31.75 31.50 31.75 31.50;
31.50 31.75 32.25 31.50;
31.50 31.50 32.00 31.75;
31.50 31.25 32.00 31.50;
31.00 31.75 32.25 31.50;
31.50 32.00 32.25 31.50;
31.50 31.50 31.75 31.00;
31.75 31.75 32.00 31.25;
31.50 31.75 32.25 31.25;
31.50 31.50 32.25 31.00;
31.50 32.00 32.00 31.50;
31.50 32.00 31.75 31.50;
31.00 31.50 32.00 31.50;
31.00 32.00 31.75 31.25;
31.50 31.75 32.25 31.50;
31.50 31.75 31.50 31.50;
31.25 31.50 31.50 31.50;
31.25 31.25 32.00 31.00;
30.50 31.25 31.75 32.25;
31.75 31.75 32.00 31.75;
34.00 31.75 31.50 30.75;
35.25 32.25 31.75 31.00;
33.75 32.50 32.00 31.75;
35.25 32.75 32.25 31.75;
36.50 32.75 31.50 30.00;
37.75 33.75 32.50 30.75;
38.00 33.25 32.25 32.25;
37.50 33.75 32.50 32.50;
39.00 34.50 32.50 31.50;
40.50 34.75 32.75 30.75;
40.75 35.00 32.75 31.50;
39.50 35.50 33.50 32.75;
40.25 35.75 33.25 32.00;
42.00 36.00 33.50 32.00;
43.00 36.75 34.00 31.75;
42.00 37.00 34.00 32.50;
41.50 37.25 34.00 33.00;
42.25 37.50 34.50 33.00;
43.75 37.75 35.25 32.00;
44.00 38.25 35.00 32.75;
43.75 38.50 35.50 33.25;
43.25 39.00 35.50 34.50;
44.00 39.00 35.75 33.75;
45.75 39.50 36.50 33.50;
45.75 39.25 35.75 34.00;
45.00 40.25 36.75 35.00;
44.75 40.00 36.50 35.50;
45.75 40.75 37.25 34.50;
46.75 41.00 37.50 33.75;
47.00 41.25 37.25 34.50;
46.25 40.75 37.50 36.00;
45.75 41.25 38.25 36.25;
46.00 41.75 38.00 35.75;
48.00 41.75 38.75 35.25;
47.50 42.25 38.75 36.25;
47.00 42.25 39.25 37.00;
46.25 42.00 39.00 37.50;
47.50 42.25 39.25 36.75;
49.50 43.25 39.25 36.25;
49.00 43.25 40.00 37.00;
48.00 43.25 40.25 38.00;
47.75 44.00 40.75 38.25;
49.00 44.00 40.75 38.00;
50.50 43.50 40.75 37.25;
50.50 44.25 40.75 38.25;
48.75 44.00 41.25 39.25;
48.75 45.00 40.75 39.50;
49.75 45.00 41.75 39.25;
51.75 45.50 42.25 38.75;
50.75 45.50 41.75 39.25;
50.25 45.75 42.25 40.50;
50.25 46.00 42.75 40.25;
52.00 46.25 42.75 40.25;
53.00 46.25 43.25 39.75;
53.00 46.75 43.00 40.75;
52.00 47.00 43.25 41.50;
52.25 47.00 44.00 41.75;
54.50 47.75 44.00 40.75;
55.25 48.25 44.00 41.00;
54.25 48.50 45.00 42.25;
53.50 49.00 45.00 42.75;
54.50 48.75 45.00 42.75;
56.50 49.25 45.25 41.75;
56.50 49.50 45.50 42.50;
55.25 49.75 45.75 43.25;
54.50 50.00 46.50 44.25;
56.00 50.75 46.75 43.75;
57.75 50.75 47.00 43.50;
57.25 50.75 46.25 43.00;
56.25 51.50 46.50 44.75;
56.00 51.50 47.25 45.25;
57.50 51.50 47.50 44.25;
58.50 51.50 47.50 44.50;
58.25 52.00 48.25 45.00;
57.25 52.25 48.50 45.50;
57.00 52.75 48.50 46.25;
57.75 52.75 49.00 46.25;
59.50 52.75 49.00 45.75;
60.00 53.50 49.50 46.00;
59.00 53.25 49.25 47.00;
58.25 54.00 49.25 47.75;
58.25 53.75 50.25 48.00;
60.00 54.25 50.75 47.50;
61.00 54.50 50.50 47.25;
60.50 54.50 51.00 47.50;
59.00 54.75 51.00 49.00;
59.25 55.00 50.75 49.25;
60.50 55.25 51.75 48.75;
61.75 55.00 52.00 48.50;
61.75 55.75 52.00 48.75;
60.75 55.50 52.50 49.75;
60.00 56.25 52.25 50.50;
60.50 56.25 52.25 50.25;
62.25 56.50 53.00 49.75;
62.25 56.25 53.00 50.00;
61.50 57.25 53.00 50.50;
60.75 57.00 53.75 51.50;
61.50 57.50 53.00 51.75;
63.00 57.50 54.00 50.75;
63.50 57.25 54.25 51.25;
62.00 57.75 54.75 52.25;
61.50 58.00 55.00 52.75;
62.75 57.75 55.00 52.00;
64.00 58.25 54.75 52.00;
63.75 58.75 54.75 52.00;
62.50 58.50 55.00 53.00;
62.00 58.50 55.75 53.75;
64.25 58.75 55.75 53.00;
64.50 59.25 56.00 53.00;
64.00 59.25 56.00 53.50;
62.50 59.50 56.00 54.00;
63.50 59.25 56.25 54.00;
64.75 59.75 56.50 53.75;
65.00 59.75 56.25 54.25;
63.50 60.00 57.25 55.25;
63.25 60.50 57.25 55.00;
64.75 60.25 57.75 54.50;
65.75 60.25 57.75 54.75;
64.75 60.75 57.75 55.50;
63.75 60.75 57.75 56.25;
64.25 60.75 58.00 56.25;
66.00 61.25 58.25 55.50;
66.00 60.75 58.25 55.75;
63.75 61.50 58.50 56.75;
64.25 61.25 59.00 57.00;
65.75 61.50 59.00 56.50;
66.25 61.50 58.75 56.25;
65.50 61.50 59.25 56.75;
64.50 62.00 59.50 58.00;
65.75 62.00 59.50 57.50;
67.00 62.50 59.50 57.00;
66.50 62.00 59.75 57.50;
65.25 62.25 60.00 58.50;
65.25 62.50 59.50 58.50;
66.75 62.25 60.50 57.75;
67.25 62.75 60.00 57.25;
65.75 63.00 60.75 58.50;
65.50 62.75 60.75 59.00;
67.25 62.75 60.75 58.50;
68.00 63.25 61.00 58.50;
67.00 63.50 61.00 59.50;
65.75 63.75 61.00 60.00;
67.25 63.75 61.25 59.75;
68.50 63.25 61.50 59.00;
67.25 64.00 61.75 59.75;
66.50 63.75 61.50 60.50;
66.50 64.25 62.00 60.25;
68.50 64.50 62.00 59.75;
68.75 64.50 62.25 59.75;
67.25 65.00 62.50 60.25;
66.50 64.50 62.25 61.00;
68.00 64.75 62.50 60.50;
69.50 65.00 62.50 60.00;
68.50 65.00 62.75 61.00;
67.00 65.00 63.25 61.75;
67.75 65.50 62.75 61.50;
69.50 65.50 62.75 60.75;
69.50 65.50 63.25 61.25;
68.00 65.75 63.50 61.75;
68.00 65.50 63.75 62.25;
69.00 65.50 64.00 61.50;
70.00 66.00 64.00 61.50;
69.25 65.75 64.00 62.25;
68.00 66.25 64.25 63.00;
68.50 66.75 64.50 62.75;
70.25 66.75 64.50 62.00;
70.25 66.75 64.25 62.00;
69.00 66.50 64.50 63.25;
68.75 66.50 65.00 63.75;
70.00 66.75 64.50 63.00;
70.75 67.25 65.25 62.75;
70.25 67.00 65.25 63.00;
68.75 67.25 65.00 64.00;
69.50 67.50 65.50 63.75;
70.75 67.25 65.50 63.25;
70.75 67.50 65.50 63.25;
70.00 67.75 66.00 64.25;
69.50 67.75 65.75 64.75;
70.25 67.50 65.75 64.25;
71.25 67.75 65.75 63.50;
70.50 67.75 65.75 64.25;
69.25 68.00 66.00 64.75;
69.75 67.75 66.00 64.75;
71.00 68.25 66.00 64.25;
71.50 68.00 66.50 64.25;
70.00 67.75 66.00 65.50;
70.00 68.25 66.50 65.75;
70.75 68.50 67.00 65.25;
72.25 68.25 67.00 64.75;
70.75 68.75 67.00 65.50;
70.00 68.75 66.75 65.75;
71.00 68.75 67.25 65.75;
72.00 68.75 67.25 65.00;
72.25 69.00 66.75 65.75;
70.25 69.00 67.50 66.25;
70.75 69.25 67.50 66.25;
72.00 69.00 67.75 65.50;
73.00 68.75 67.75 65.75;
71.50 69.50 68.00 65.75;
71.00 69.50 68.00 67.00;
71.50 69.50 68.25 66.75;
73.00 69.50 68.25 66.25;
73.25 69.75 68.25 66.00;
71.75 69.50 67.75 66.50;
71.00 69.75 68.50 66.75;
72.00 70.25 68.75 66.75;
73.50 70.25 68.50 66.75;
73.50 70.25 68.75 66.75;
71.75 70.25 68.75 67.50;
71.00 70.50 68.75 68.00;
72.25 70.00 69.00 67.50;
73.25 70.25 69.00 66.50;
73.50 70.25 68.50 67.50;
72.50 70.75 69.00 68.00;
72.00 70.75 69.75 68.00;
73.50 70.25 69.50 68.00;
74.25 71.00 69.00 67.25;
73.50 71.00 69.50 67.75;
71.75 71.00 69.75 68.25;
72.75 71.25 69.75 68.50;
73.50 71.00 70.00 68.00;
74.25 71.25 70.25 68.00;
73.25 71.50 70.00 68.00;
72.50 71.50 70.25 69.25;
73.00 71.50 70.25 68.50;
74.25 71.50 70.25 68.50;
74.50 71.25 70.00 68.25;
73.75 71.75 70.00 68.50;
72.50 72.00 70.25 69.50;
72.75 71.50 70.00 69.25;
74.50 72.00 70.75 68.75;
75.00 72.00 70.50 68.75;
73.00 72.00 71.00 69.75;
73.25 72.25 71.00 70.25;
74.00 71.75 70.50 69.75;
75.25 72.25 71.00 68.75];
dy=0.025;
A=[-2 1 0 0;1 -2 1 0;0 1 -2 1;0 0 1 -1];
B=[1 1 1 1];
C=[-80 0 0 0];
dt1=zeros(280,1);
dt2=zeros(280,1);
dt3=zeros(280,1);
dt4=zeros(280,1);
% alpha=zeros(280,4);
% for i=1:280
%     dt1(i)=T(i+1,1)-T(i,1);
%     alpha(i,1)=(dy^2)*(dt1(i,1)/(T(i,2)+78-2*T(i,1)));
%     dt2(i)=T(i+1,2)-T(i,2);
%     alpha(i,2)=(dy^2)*(dt2(i,1)/(T(i,3)+T(i,1)-2*T(i,2)));
%     dt3(i)=T(i+1,3)-T(i,3);
%     alpha(i,3)=(dy^2)*(dt3(i,1)/(T(i,4)+T(i,2)-2*T(i,3)));
%     dt4(i)=T(i+1,4)-T(i,4);
%     alpha(i,4)=(dy^2)*(dt4(i,1)/(T(i,3)-T(i,4)));
% end
% al=0;
% count=0;
dtx=zeros(281,3);
dtx(:,1)=T(:,1)-T(:,2);
dtx(:,2)=T(:,2)-T(:,3);
dtx(:,3)=T(:,3)-T(:,4);
dtdxx=zeros(281,2);
dtdxx(:,1)=dtx(:,1)-dtx(:,2);
dtdxx(:,2)=dtx(:,2)-dtx(:,3);
for i=1:280
    dt1(i)=T(i+1,1)-T(i,1);
    %alpha(i,1)=(dy^2)*(dt1(i,1)/(T(i,2)+78-2*T(i,1)));
    dt2(i)=T(i+1,2)-T(i,2);
    %alpha(i,2)=(dy^2)*(dt2(i,1)/(T(i,3)+T(i,1)-2*T(i,2)));
    dt3(i)=T(i+1,3)-T(i,3);
    %alpha(i,3)=(dy^2)*(dt3(i,1)/(T(i,4)+T(i,2)-2*T(i,3)));
    dt4(i)=T(i+1,4)-T(i,4);
    %alpha(i,4)=(dy^2)*(dt4(i,1)/(T(i,3)-T(i,4)));
end
dtdxx=dtdxx(1:280,1:2);
alpha1=zeros(280,1);
alpha1(:,1)=dt2(:,1)./dtdxx(:,1);
count1=0;
al1=0;
for i=1:280
    if(alpha1(i,1)>-1 && alpha1(i,1)<1 && ~isnan(alpha1(i,1)))
        al1=al1+alpha(i,1);
        count1=count1+1;
    end
end
al1=al1/count1;
al1=al1*(dy*dy);
al1=al1*2700*900;
%
alpha2=zeros(280,1);
alpha2(:,1)=dt3(:,1)./dtdxx(:,2);
count2=0;
al2=0;
for i=1:280
    if(alpha2(i,1)>-1 && alpha2(i,1)<1 && ~isnan(alpha2(i,1)))
        al2=al2+alpha2(i,1);
        count2=count2+1;
    end
end
al2=al2/count2;
al2=al2*(dy*dy);
al2=al2*2700*900;
x=1:281;
plot(x,T(:,1))
hold on
plot(x,T(:,2))
hold on
plot(x,T(:,3))
hold on
plot(x,T(:,4))
legend('T1','T2','T3','T4')